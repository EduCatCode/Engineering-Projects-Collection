# 加工動態偵測模型優化設計-凱迪崩刃預警系統

## 目錄

1. [專案簡介](#專案簡介)
2. [專案目標](#專案目標)
3. [安裝電流感測模組](#安裝電流感測模組)
4. [崩刃預警系統](#崩刃預警系統)
   - [背景資料分析](#背景資料分析)
   - [演算法](#演算法)
5. [非加工程序訊號剔除](#非加工程序訊號剔除)
6. [成果展示](#成果展示)
7. [未來發展](#未來發展)


## 專案簡介

此專案旨在利用電流感測模組於凱迪 DMG MORI NHX 4000 機台主軸，以預測12∅刀具編號52崩刃預警。透過分析加工過程中的電流數據，建立一套預警系統，用於早期識別和預警潛在的崩刃風險。

## 專案目標

- **主要目標**: 透過分析加工過程中的電流數據，建立一套預警系統，用於早期識別和預警潛在的崩刃風險。
- **機台**: DMG MORI NHX 4000
- **刀具**: 12∅ 刀具編號52

| DMG MORI NHX 4000 | 壞刀 (12∅) |
|:-------:|:-------:|
|![4000](https://hackmd.io/_uploads/B1GHWejNa.jpg)|![130934](https://hackmd.io/_uploads/SkBjZxs4T.jpg)|

## 安裝電流感測模組

| 比流器安裝位置 |機盒放置位置 |
|:-------:|:-------:|
|![S__73367597](https://hackmd.io/_uploads/Sk_NM-i46.jpg)|![S__77086724_0](https://hackmd.io/_uploads/rkg6bj2tvp.jpg)|

## 崩刃預警系統

### 背景資料分析

- 廠長通知到刀具編號52出現崩刃現象，共計更換四次1/12、2/29、3/9、3/27。
- 針對刀具編號52崩刃事件，我們已初步開發出一套演算法以判斷該刀具是否發生崩刃。

### 演算法

#### 步驟 1：數據收集

- 在正常加工條件下進行400次測量，每次加工過程中每隔0.1秒記錄一次電流的RMS（均方根）值。

#### 步驟 2：建立初始管制線

- 分析步驟1中收集到的400筆正常加工數據，對每0.1秒的RMS值計算其平均值（mean）及標準差（std）。
- 根據計算結果，確定初始的管制線，即每0.1秒的RMS值不應超過的閾值（mean + std）。此管制線可視化於相應的圖表中以便參考。

|管制線可視化|加工與初始管制線比對|
|:-:|:-:|
|![output10](https://hackmd.io/_uploads/BJdu6c2i6.png)|![output12](https://hackmd.io/_uploads/rycKT9noT.png)|

#### 步驟 3：計算超管制線比例

- 對每筆加工數據，計算RMS值超出初始管制線的比例，以評估每次加工的異常程度。

#### 步驟 4：設定最終管制線

- 利用步驟3中計算出的所有加工數據超管制線的比例，求取其平均值及標準差。
- 根據這些統計數據，設定最終管制線為「超管制線比例的平均值 + 2倍標準差」。任何超過此最終管制線連續的2筆加工數據後將觸發預警，提示可能存在崩刃的風險。

![output1 - 複製](https://hackmd.io/_uploads/SyIRpq2sa.png)

> Y軸: 為單筆加工依演算法轉換的值， X軸: 為單筆加工的時間戳記（方便調閱異常資料）

## 非加工程序訊號剔除

為了確保數據的準確性和有效性，我們設計了一個簡易的剔除非加工程序訊號的過濾器，以排除如測試、測量等非加工訊號。

|異常1|異常2|異常3|
|:-:|:-:|:-:|
|![01](https://hackmd.io/_uploads/rkeDQj2ja.png)|![02](https://hackmd.io/_uploads/BJzP7sho6.png)|![03](https://hackmd.io/_uploads/rkBvmono6.png)|
|![04](https://hackmd.io/_uploads/HJOPXo3sT.png)|![05](https://hackmd.io/_uploads/rkjvmj3sT.png)|![06](https://hackmd.io/_uploads/S16w7jhsa.png)|
|![07](https://hackmd.io/_uploads/S1lOms2s6.png)|![08](https://hackmd.io/_uploads/SJEu7ohiT.png)|![09](https://hackmd.io/_uploads/B1BdXs3op.png)|

## 成果展示

以下圖表展示了我們的預警系統成果。紅色垂直線是廠商確認換刀的時間，綠色則是我們提醒廠商換刀的時間。我們基本上都有提前預警到，只有一次假警報，但廠商認為假警報比預測錯誤更好。

![成果展示](path/to/newplot.png)

## 未來發展

未來我們將繼續優化崩刃預警系統，並考慮以下發展方向：
- **數據集擴展**：增加更多不同條件下的數據集，以提高模型的泛化能力。
- **模型改進**：目前我們主要使用統計方法來進行預警分析，但未來我們計劃使用先進的機器學習和深度學習算法，以進一步提升預警的準確性。由於目前透過Windows取得的序列資料進行訓練效果不佳，我們計劃未來可以加入不同情況下的數據，每把刀具都會有多個模型，並利用機器學習或深度學習方法，選擇出最有利的模型進行訓練。這樣可以提高模型的泛化性，並且在不同加工條件下能更準確地進行預測。
