# **FANUC CNC 加工時間監控與分析工具**  

---

## **目錄**  
1. [主要成就](#主要成就)  
2. [專案簡介](#專案簡介)  
3. [專案目標](#專案目標)  
4. [架構方式](#架構方式)  
5. [未來發展](#未來發展)  

---

## **主要成就**  

- **即時監控機台狀態**：透過 FANUC CNC 控制器讀取機台的狀態資訊，包括模式、運行狀態、主軸轉速、進給速度、程序號及刀號等。  
- **資料分析功能**：自動分析機台加工循環與各刀號的加工時間，並輸出詳細的時間報告。  
- **自動化資料處理流程**：支援將數據導出為 CSV 檔案，方便後續分析或模型訓練使用。  
- **人性化操作界面**：內建 Tkinter 圖形介面，提供 CNC 連線設定、狀態監視及資料存取功能。  
- **模組化設計**：程式碼拆分為驅動模組與 UI 模組，便於擴展與維護。  

---

## **專案簡介**  

本專案為 FANUC CNC 加工監控與分析系統，利用 Python 與 FANUC 提供的 Fwlib64.dll 函式庫實現 CNC 通訊功能。  
專案提供以下主要功能：  
1. 即時監控機台加工狀態，包括進給速度、主軸轉速與程序段號等。  
2. 以 Tkinter 建構使用者界面，讓使用者能夠方便地設定 CNC 連線並觀察狀態。  
3. 自動化資料分析，計算各加工刀號的使用時間與總加工時間，便於流程優化與維修檢測。  
4. 支援將資料導出為 CSV 格式，適合後續機器學習模型或報表分析使用。  

---

## **專案目標**  

1. **簡化 CNC 監控流程**：  
   - 取代手動記錄機台狀態的傳統方式，提高監控效率與準確性。  

2. **提供自動化分析工具**：  
   - 快速分析加工循環，找出瓶頸與異常情況。  

3. **資料整合與格式化輸出**：  
   - 支援將監控資料匯出為 CSV，供模型訓練或統計分析。  

4. **提升維修檢測效率**：  
   - 透過數據分析幫助維修人員快速定位問題刀號或異常加工時間，縮短停機時間。  

---

## **架構方式**  

### **1. 系統架構圖**  

```
+-------------------+       +------------------+
|   Tkinter UI      | <---> |   CNC 通訊驅動    |
+-------------------+       +------------------+
           |                           |
           |                           v
+-------------------+       +------------------+
|   數據處理與分析    | <---> |   Fwlib64.dll     |
+-------------------+       +------------------+
           |
           v
+-------------------+
| CSV 儲存與導出     |
+-------------------+
```


### **2. 功能模組**  

1. **CNC 通訊驅動模組 (Fanuc0ifDrive)**  
   - 使用 ctypes 呼叫 FANUC 提供的 Fwlib64.dll 函式庫，實現 CNC 資料讀取與控制功能。  
   - 支援 CNC 狀態資訊讀取、刀號與程序段號等數據抓取。  

2. **資料分析模組 (analyze_process)**  
   - 分析加工循環中的各工序時間，並計算總加工時間。  
   - 自動識別機台閒置狀態與刀號變更，以便準確記錄加工過程。  

3. **資料存取模組 (save_csv)**  
   - 將監控資料保存為 CSV 格式，適合後續分析或機器學習使用。  

4. **使用者界面模組 (Tkinter)**  
   - 提供 CNC 連線設定與狀態顯示功能。  
   - 支援分析報告顯示與數據存取操作。  

---

## **未來發展**  

1. **多機台監控支持**：  
   - 擴展支持多台 CNC 機台同時連線與監控，適合生產線管理應用。  

2. **雲端數據同步與分析**：  
   - 整合雲端資料庫，實現遠端監控與歷史數據分析。  

3. **自動異常偵測與警報功能**：  
   - 加入異常偵測演算法，透過數據分析判斷是否出現加工異常並發送警報通知。  

4. **機器學習分析模型導入**：  
   - 結合機器學習技術分析加工數據，預測刀具壽命或異常情況，進一步優化生產流程。  

5. **支援多品牌 CNC 控制器**：  
   - 擴展驅動模組以支持其他品牌 CNC，如 Mitsubishi 或 Siemens。  

6. **報表生成功能**：  
   - 自動生成報表（如 PDF 或 Excel），方便管理層查看分析結果。  

---

## **專案結論**  

此 FANUC CNC 加工監控與分析系統專案透過即時數據讀取與分析工具，能有效監測機台狀態、分析加工時間，並協助維修與生產管理。  
未來將進一步整合異常警報與機器學習模型，提升加工效率與智能化水平，適合自動化工廠與智慧製造環境應用。  
