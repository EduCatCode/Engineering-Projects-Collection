# Office Genie 辦公精靈 - 專案說明

## 概觀
此專案是一個以 Python 建置的 GUI 應用程式，使用了 `tkinter` 搭配 `ttkbootstrap` 來建立現代化的使用者介面。專案主要包含兩個功能頁籤：
1. **Download Function**：利用 `yt_dlp` 從網路上下載影片/音訊，並支援選擇不同格式與畫質。
2. **Whisper Function**：使用 OpenAI 的 `whisper` 模型（或本地模型）將音訊轉換為文字。首次使用時會下載指定模型（下載至當前目錄），之後則直接從本地載入以節省下載時間與頻寬。

此外，還有一個 **Summary Function** 頁籤，目前作為未來功能的佔位頁面。
![螢幕擷取畫面 2025-02-01 204423](https://hackmd.io/_uploads/Sk5rD9jdkx.jpg)


## 關鍵功能與效能說明

### 1. Download Function
- **功能描述**：
  - 使用者可輸入影片 URL 並載入影片資訊（標題、可用格式、畫質及檔案大小）。
  - 提供 MP4（影片）與 MP3（音訊）兩種下載格式選項，並根據使用者選擇的畫質進行匹配。
  - 下載過程中，進度條會即時顯示下載進度（以百分比表示）。
  - 下載完成後，自動開啟儲存下載內容的資料夾。
  
- **量化描述**：
  - 進度條以數值（0% ~ 100%）呈現實際下載進度，根據影片總大小與已下載位元組動態更新。
  - 若影片大小為 50MB，進度條將依照每個下載進度比例更新，精確反應下載情況。

![螢幕擷取畫面 2025-02-01 204343](https://hackmd.io/_uploads/S1xHv9o_1x.jpg)


### 2. Whisper Function
- **功能描述**：
  - 使用者可選擇要轉換的音檔，並指定文字檔的儲存路徑。
  - 提供模型選擇功能：選項包括 ["tiny", "base", "small", "medium", "large", "local"]。
    - **首次選擇（非 local）**：若該模型未曾下載，會自動下載至當前目錄。
    - **再次選擇**：若模型已下載並載入，則直接重複使用，不再重新下載。
  - 在語音轉文字過程中，進度條會以 indeterminate 模式運作，告知使用者處於處理狀態，並在完成後切換為 determinate 模式並顯示 100%。
  
- **量化描述**：
  - 模型下載：首次下載模型可能耗時 30 秒到 2 分鐘，視網速與模型大小而定；之後載入則通常在 5 秒內完成。
  - 語音轉文字：進度條採用 indeterminate 模式反映處理中狀態，最終完成後進度條顯示 100%，並以訊息提示轉換完成。轉換時間依音檔長度與選擇的模型而有所不同，通常介於 30 秒至數分鐘之間。

![螢幕擷取畫面 2025-02-01 204403](https://hackmd.io/_uploads/ryBrvcju1x.jpg)


## 技術細節
- **GUI 與設計**：
  - 使用 `tkinter` 建構主視窗，並透過 `ttkbootstrap` 提供現代化的主題（例如 "superhero"）。
  - 採用 Notebook 方式組織多頁籤介面，每個頁籤獨立實現不同功能。
  
- **下載功能**：
  - 透過 `yt_dlp` 進行影片資訊提取與下載，支援 MP4 與 MP3 格式轉換，並利用 FFmpeg 進行後處理。
  
- **語音轉文字**：
  - 依據使用者所選模型，若模型不存在則透過 `whisper.load_model` 搭配 `download_root` 參數下載至當前目錄。
  - 支援本地模型（"local" 選項），使用 `whispercpp` 進行轉錄。
  - 多執行緒機制確保長時間任務（如下載與轉錄）不會凍結 GUI。
  
- **效能與使用者體驗**：
  - 模型載入後會被緩存於 `loaded_models` 字典中，避免重複下載，從而提升後續轉錄速度。
  - 實時更新的進度條與明確的狀態訊息（例如 "轉換中，請稍候..."）提供良好的使用者體驗。

## 專案結構


OfficeGenie/ 
<br>├── main.py # 主應用程式：包含 GUI 與所有功能實作 
<br>├── README.md # 專案說明文件（本文件） 
<br>├── requirements.txt # 專案相依性列表（例如：ttkbootstrap, yt_dlp, whisper 等） 
<br>└── models/ # (可選) 存放已下載模型的目錄

## 設定與執行說明
1. **前置需求**：
   - Python 3.9 或更新版本。
   - 安裝所需套件：
     ```bash
     pip install ttkbootstrap yt_dlp whisper
     ```
   - 若使用本地模型轉錄，請確認已安裝 `whispercpp` 及其依賴。

2. **執行應用程式**：
   - 在專案根目錄下執行：
     ```bash
     python main.py
     ```

3. **使用方式**：
   - **Download Function**：輸入影片 URL，點選「載入影片資訊」後選擇格式與畫質，再點選「下載」開始下載影片或音訊。
   - **Whisper Function**：選擇音檔與儲存文字檔路徑，選擇欲使用的模型。第一次使用選定模型時，會下載並存放於當前目錄，之後則直接從本地載入模型進行語音轉文字處理。
   - **Summary Function**：目前為未來擴充功能的佔位頁面。

## 總結
Office Genie 辦公精靈專案結合了多媒體下載與語音轉文字功能，並藉由現代化的 GUI 介面提供使用者簡單直覺的操作體驗。專案在技術上注重：
- **質的方面**：清晰的操作介面、強健的錯誤處理機制、多執行緒避免介面凍結、模型緩存提升效能。
- **量的方面**：進度條精確顯示下載百分比（0% ~ 100%）、模型下載及轉錄時間顯著縮短（後續載入時間 < 5 秒）。

此專案展現如何有效結合多個第三方工具與現代化 Python 開發規範，打造出一個高效、易用且具擴展性的辦公自動化工具。
